{% extends "base.html" %}

{% block title %}{{ file.original_filename }} - FileVault{% endblock %}

{% block content %}
<div class="file-view">
    <div class="file-view-header">
        <a href="{{ url_for('dashboard') }}" class="back-link">
            <i class="fas fa-arrow-left"></i>
            Back to Dashboard
        </a>
        <div class="file-view-actions">
            <a href="{{ url_for('download_file', file_id=file.id) }}" class="btn btn-primary">
                <i class="fas fa-download"></i>
                Download
            </a>
            <form method="POST" action="{{ url_for('delete_file', file_id=file.id) }}" class="delete-form" onsubmit="return confirm('Are you sure you want to delete this file?');">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="btn btn-danger">
                    <i class="fas fa-trash"></i>
                    Delete
                </button>
            </form>
        </div>
    </div>

    <div class="file-view-content">
        <div class="file-preview-large">
            {% if file.is_image() %}
                <img src="{{ url_for('serve_file', filename=file.stored_filename) }}" alt="{{ file.original_filename }}">
            {% elif file.file_type == 'pdf' %}
                <div class="pdf-preview">
                    <iframe src="{{ url_for('serve_file', filename=file.stored_filename) }}" type="application/pdf"></iframe>
                </div>
            {% elif file.file_type == 'video' %}
                <video controls>
                    <source src="{{ url_for('serve_file', filename=file.stored_filename) }}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            {% elif file.file_type == 'audio' %}
                <div class="audio-preview">
                    <i class="fas fa-music"></i>
                    <audio controls>
                        <source src="{{ url_for('serve_file', filename=file.stored_filename) }}" type="audio/mpeg">
                        Your browser does not support the audio tag.
                    </audio>
                </div>
            {% else %}
                <div class="file-icon-large">
                    <i class="fas {{ file.get_file_icon() }}"></i>
                    <p>Preview not available for this file type</p>
                </div>
            {% endif %}
        </div>

        <div class="file-details">
            <h1>{{ file.original_filename }}</h1>
            <div class="file-details-grid">
                <div class="detail-item">
                    <span class="detail-label"><i class="fas fa-file"></i> Type</span>
                    <span class="detail-value">{{ file.file_type|capitalize }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label"><i class="fas fa-hdd"></i> Size</span>
                    <span class="detail-value">{{ file.formatted_size }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label"><i class="fas fa-calendar"></i> Uploaded</span>
                    <span class="detail-value">{{ file.uploaded_at.strftime('%B %d, %Y at %I:%M %p') }}</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
